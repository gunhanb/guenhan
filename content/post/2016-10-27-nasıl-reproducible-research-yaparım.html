---
title: Nasıl "reproducible research" yaparım?
author: Burak Kürsad Günhan
date: '2016-10-27'
slug: nasıl-reproducible-research-yaparım
categories:
  - R
tags:
  - Turkish
header:
  caption: ''
  image: ''
---



<p>Diyelim ki bir arkadaşınız yaklaşık bir sene önce tamamlamış olduğunuz bir <em>research</em> calışmanızdan birşey sordu. Calısmanıza dönüp analizleri tekrar gözden geçirmek, tablo ve figürleri <em>reproduce</em> edebilmeniz ne kadar vaktinizi alacaktır? Veya arkadaşınızı boşverin, sadece kendiniz 2 sene önce hazırlamış olduğunuz sunumdaki <em>result</em>larin tekrar elde etmeye calışsanız? Bu süreyi ve olası zahmeti azaltmanın (ve daha fazlası) metodu <em>reproducible research</em> yapmanız!</p>
<p>Eğer günlük hayattaki calışmalarınızda bir sekilde <em>data analysis</em> yapıyorsaniz, eski yontemler yerine <em>reproducible research</em> kullanmaniz belki biraz daha zahmetli ama uzun vadede kesinlikle daha faydali.</p>
<p>Bir başka açıdan bakacak olursak, geleneksel rapor yazımında, sonuçları bir software de hesaplayip, sonra da hesaplamış oldugumuz sayılari elle sonuç bölümüne yazarız. Ama bu yöntem reproducible değil, data <em>software</em> e bağlı fakat sonuçlar yazdıgımız metne bağlı değil, dolayısıyla hata yapma ihtimali bir hayli yüksek.</p>
<p>Bu konu tabiiki bayağı geniş ve kapsamlı, ayrica niyetim bir <em>manual</em> yazmak değil. Bu yazıda amacım kendi tecrübelerimden faydalanarak tamamen pratik açıdan reproducible research’u kısaca anlatmaya calişmak (<a href="http://reproducibleresearch.net">daha ayrıntılı bilgi için tıklayin</a>). Turkce yazmamın amacı da bu konulardaki Türkçe materyallerin eksikliği.</p>
<p>Ilk olarak data analysis’i hangi <em>software</em> de yapacagim sorusu karsimiza geliyor. Bir istatistikci oldugum icin buna verecegim cevap tabiki <a href="https://www.r-project.org"><strong>R</strong></a> (since <strong>R</strong> is made by statisticians for statisticians!). Ikinci olarak <em>typesetting</em> programimizi belirlememiz gerekiyor, raporu/makaleyi/tezi yazacagimiz veya sunumu hazirlayacagimiz program. Buna cevabimiz ise <em>LaTeX</em> olabilir. Fakat diger guclu bir alternatif ise <a href="https://daringfireball.net/projects/markdown/"><em>Markdown</em></a>. Markdown ile hem pdf, word veya HTML output elde edebiliyoruz. Bu yazida <em>Markdown</em> kullanacagiz, cünkü bize Ve ucuncu olarak bize uygun bir <em>text editor</em> gerekli, bunun icin de <strong>Rstudio</strong> yu kullaniyoruz. Sonunda sihirli dokunusu yapacak yani reproducible research u mumkun kilacak olan program (aslinda bir <strong>R</strong> <em>package</em>): <strong>knitr</strong>. Tam burada <strong>knitr</strong> in babasi olan programi hatirlatmam gerekiyor, saygi geregi <strong>Sweave</strong>.</p>
<p>Dolayisiyla <strong>knitr</strong> ile birlikte bu uc program, <strong>R</strong> + Markdown + <strong>Rstudio</strong>, bize reproducible research yapabilmemiz icin yeterli ve bu arada hepsi de free software. Kisacasi bir tek <em>document</em> a hem LaTeX kodu hem de <strong>R</strong> kodunu yaziyorsunuz (.Rmd file) ve sonrasinda <em>compile</em> edip PDF inize kavusmus oluyorsunuz. Aslina bakarsaniz, <strong>knitr</strong> kullanarak reproducible research yapabilmemiz icin bu uc programin hicbiri farz degil, alternatif kombinasyonlara en sonda deginecegim. Rstudio nun sagladigi en onemli fayda ise <em>compile to PDF</em> adimini sadece tek bir tusa indirgiyor olusu.</p>
<div id="basit-bir-ornek" class="section level2">
<h2>Basit bir ornek</h2>
<p><em>Base R</em> dan <em>cars</em> adli <em>dataset</em> i kullanacagiz. Bu dataset farkli arabalarin hizlari (<em>speed variable</em>) ve her bir arabanin durmak icin gerekli mesafelerini (<em>dist variable</em>) iceriyor. Bu datayi analiz etmek icin <em>linear regression</em> kullaniyoruz ve gerekli <strong>R</strong> kodu asagidaki gibi gosterebiliriz.</p>
<pre class="r"><code>fit &lt;- lm(dist ~ speed, data = cars) # linear regression </code></pre>
<p>Tabii sonuclari -mesela bu ornekte <em>coefficients</em>- bir tabloda gostermek isteyebiliriz. Bunun icin de <strong>xtable</strong> (bir <strong>R</strong> package) bize yardimci olacak. Asagidaki <strong>R</strong> kodu bize gerekli HTML kodu veriyor, ve compile ettikten sonra da Tablo 1’i elde ediyoruz.</p>
<pre class="r"><code>library(knitr)
coefs &lt;- matrix(coef(fit))
rownames(coefs) &lt;- c(&quot;Intercept&quot;, &quot;speed&quot;)
kable(coefs, label = &quot;tab:coefs&quot;,
      digits = 2,
      row.names = TRUE, 
      col.names = &quot;Estimate&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td align="right">-17.58</td>
</tr>
<tr class="even">
<td>speed</td>
<td align="right">3.93</td>
</tr>
</tbody>
</table>
<p>Normal sartlarda tabloyu yaratan <strong>R</strong> kodu okuyucuya gostermeye gerek yok fakat ben ornek olmasi acisindan gosteriyorum.</p>
<p>Simdi ise <em>data visualization</em>. Asagidaki <strong>R</strong> kod ile Figure 1’i elde ediyoruz.</p>
<pre class="r"><code>library(ggplot2)
ggplot(cars, aes(x = speed, y = dist)) + geom_point() +
  geom_abline(intercept = coef(fit)[1], slope = coef(fit)[2])</code></pre>
<p><img src="/post/2016-10-27-nas%C4%B1l-reproducible-research-yapar%C4%B1m_files/figure-html/figure-1.png" width="384" /></p>
<p>Bu ornekte damaginiza <strong>knitr</strong> kullanimindan bir tat calmayi amacladim.</p>
<p>Benim ugrastigim problemlerde <strong>knitr</strong> in saglamis oldugu cok onemli diger bir fayda ise <em>cache</em> ozelligi. Simdi farz edin ki analiziniz yukaridaki gibi bir simple linear regression degil, mesela simulasyon yapiyorsunuz veya <em>bootstrapping</em>. Dolayisiyla islem saatler surebilir. Bu durumda <strong>knitr</strong> in cache ozelligini kullanabilirsiniz, ilk compilation da analiz yapilir (artik ne kadar suruyorsa) ve <strong>knitr</strong> sizin icin outputu kaydeder. Sonraki compilationlarda ise knitr kaydedilmis outputu kullanir!</p>
<p>Bu arada <strong>knitr</strong>’i her turlu farkli LaTeX <em>documentclass</em> icin kullanabilirsiniz, mesela rapor yazarken veya sunumunuzu hazirlarken. Diyelim ki sunumunuzdaki bir analizde kucuk bir degisiklik yapmak istiyorsunuz, artik cok kolay ve pratik bir sekilde bunu yapabilirsiniz.</p>
</div>
<div id="kapanis" class="section level2">
<h2>Kapanis</h2>
<p>Daha once soyledigim gibi <strong>knitr</strong> bayagi flexible. Mesela LaTeX kullanmak istemiyorsaniz, <strong>R</strong> + <strong>Markdown</strong> + <strong>Rstudio</strong> da gayet guzel bir alternatif sizin icin. Boylece HTML ve ya Word output da elde edebilirsiniz, PDF in yaninda (ozellikle LaTeX bilmiyorsaniz). Veyahut <strong>R</strong> yerine <strong>Phyton</strong>, <strong>SAS</strong>, <strong>Ruby</strong> kullanabilirsiniz, <strong>Rstudio</strong> yerine <strong>LyX</strong>, <strong>Texmaker</strong> veya <strong>Emacs</strong> kullanabilirsiniz. Fakat bence <strong>Rstudio</strong> dan sasmamak en mantiklisi cunku Rstudio knitr icin <em>build-in support</em> a sahip. Muhtemelen bunun onemli bir nedeni <strong>knitr</strong> in yaraticisinin bir <strong>Rstudio</strong> calisani olmasi. Hepsi ve daha fazlasi icin <a href="http://yihui.name/knitr/"><strong>knitr</strong> in websitesine bakabilirsiniz</a>. Son olarak, bu yazinin kendisi de <strong>knitr</strong> kullanarak reproducible research’e bir ornek, source code’a <a href="https://raw.githubusercontent.com/gunhanb/blog/gh-pages/_source/2016-10-27-reproducible-research.Rmd">buradan ulasabilirsiniz</a>.</p>
</div>
